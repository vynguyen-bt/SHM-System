<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Fixed Ranges - SHM-BIM-FEM</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #f9f9f9;
        }
        .test-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #2980b9;
        }
        .success {
            color: #27ae60;
            font-weight: bold;
        }
        .warning {
            color: #f39c12;
            font-weight: bold;
        }
        .error {
            color: #e74c3c;
            font-weight: bold;
        }
        .info-box {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .code {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”§ Fixed Ranges Test - SHM-BIM-FEM</h1>
            <p>Test vÃ  verify viá»‡c cá»‘ Ä‘á»‹nh pháº¡m vi hiá»ƒn thá»‹ cho biá»ƒu Ä‘á»“ 3D damage visualization</p>
        </div>

        <div class="info-box">
            <h3>ğŸ“Š Fixed Ranges Configuration:</h3>
            <ul>
                <li><strong>X-axis (EX):</strong> [0, 10] meters - FIXED</li>
                <li><strong>Y-axis (EY):</strong> [0, 10] meters - FIXED</li>
                <li><strong>Z-axis (Damage Index):</strong> [0, 25] (0-25%) - FIXED, 750px height</li>
                <li><strong>Camera Center:</strong> (5, 5, 12.5) - Center of fixed ranges</li>
                <li><strong>Threshold Plane:</strong> [-0.5, 10.5] with 5% margin</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>ğŸ§ª Test Functions</h3>
            <button class="test-button" onclick="runConfigurationSummary()">
                ğŸ“‹ Show Configuration Summary
            </button>
            <button class="test-button" onclick="runImplementationTest()">
                ğŸ” Test Implementation
            </button>
            <button class="test-button" onclick="runConsoleCheck()">
                ğŸ“Š Check Console Output
            </button>
            <button class="test-button" onclick="clearConsole()">
                ğŸ§¹ Clear Console
            </button>
        </div>

        <div class="test-section">
            <h3>ğŸ“‹ Test Results</h3>
            <div id="test-results">
                <p>Click cÃ¡c button test Ä‘á»ƒ xem káº¿t quáº£...</p>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ¯ Expected Benefits</h3>
            <ul>
                <li>âœ… Consistent visualization across all modes and sections</li>
                <li>âœ… Standardized exported images for comparison</li>
                <li>âœ… Predictable chart layouts regardless of data range</li>
                <li>âœ… Improved batch download consistency</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>âš ï¸ Considerations</h3>
            <ul>
                <li>ğŸ“Š Elements outside [0, 10]m range may be clipped</li>
                <li>ğŸ“Š Damage indices 0-25% will have full scale visibility (750px height)</li>
                <li>ğŸ“Š Large damage indices (>25%) will be clipped at Z=25</li>
            </ul>
        </div>

        <div class="info-box">
            <h3>ğŸ”§ Manual Testing Instructions:</h3>
            <ol>
                <li>Load SElement.txt file in main application</li>
                <li>Load Healthy.txt and Damage.txt files</li>
                <li>Run damage detection for any mode</li>
                <li>Check 3D chart displays with fixed ranges</li>
                <li>Test "Download Multi-Mode 3D Charts" for consistency</li>
                <li>Compare charts from different modes - should have same axis ranges</li>
            </ol>
        </div>
    </div>

    <!-- Include the calculations.js file -->
    <script src="js/calculations.js"></script>
    
    <script>
        function runConfigurationSummary() {
            console.clear();
            if (typeof logFixedRangesConfiguration === 'function') {
                logFixedRangesConfiguration();
                updateResults('âœ… Configuration summary logged to console', 'success');
            } else {
                updateResults('âŒ logFixedRangesConfiguration function not found', 'error');
            }
        }

        function runImplementationTest() {
            console.clear();
            if (typeof testFixedRangesImplementation === 'function') {
                const result = testFixedRangesImplementation();
                if (result) {
                    updateResults('âœ… Implementation test completed successfully', 'success');
                } else {
                    updateResults('âš ï¸ Implementation test completed with warnings (check console)', 'warning');
                }
            } else {
                updateResults('âŒ testFixedRangesImplementation function not found', 'error');
            }
        }

        function runConsoleCheck() {
            const results = [];
            
            // Check if functions exist
            const functions = [
                'logFixedRangesConfiguration',
                'testFixedRangesImplementation',
                'centralizeCoordinateTransformation',
                'calculateRealElementSize',
                'draw3DDamageChart'
            ];
            
            functions.forEach(funcName => {
                if (typeof window[funcName] === 'function') {
                    results.push(`âœ… ${funcName}: Available`);
                } else {
                    results.push(`âŒ ${funcName}: Not found`);
                }
            });
            
            // Check mesh data
            if (window.meshData && window.meshData.elements) {
                results.push(`âœ… Mesh data: ${window.meshData.elements.length} elements loaded`);
            } else {
                results.push(`âš ï¸ Mesh data: Not loaded (load SElement.txt first)`);
            }
            
            updateResults(results.join('<br>'), 'info');
        }

        function clearConsole() {
            console.clear();
            updateResults('ğŸ§¹ Console cleared', 'info');
        }

        function updateResults(message, type) {
            const resultsDiv = document.getElementById('test-results');
            const timestamp = new Date().toLocaleTimeString();
            const className = type || 'info';
            
            resultsDiv.innerHTML = `
                <div class="${className}">
                    [${timestamp}] ${message}
                </div>
                ${resultsDiv.innerHTML}
            `;
        }

        // Auto-run on page load
        window.addEventListener('load', () => {
            setTimeout(() => {
                updateResults('ğŸš€ Fixed Ranges Test Page loaded', 'success');
                updateResults('ğŸ“‹ Open browser console (F12) to see detailed logs', 'info');
                
                // Auto-run configuration summary
                if (typeof logFixedRangesConfiguration === 'function') {
                    logFixedRangesConfiguration();
                }
            }, 1000);
        });
    </script>
</body>
</html>
